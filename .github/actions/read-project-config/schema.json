{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/cuioss/cuioss-organization/main/.github/actions/read-project-config/schema.json",
  "title": "cuioss project.yml Configuration",
  "description": "Configuration schema for cuioss reusable GitHub Actions workflows",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "description": "Repository name"
    },
    "description": {
      "type": "string",
      "description": "Repository description"
    },
    "maven-build": {
      "type": "object",
      "description": "Maven build configuration",
      "properties": {
        "java-versions": {
          "type": "string",
          "description": "JSON array of Java versions for matrix build",
          "default": "[\"21\",\"25\"]",
          "examples": ["[\"21\",\"25\"]", "[\"17\",\"21\"]"]
        },
        "java-version": {
          "type": "string",
          "description": "Primary Java version for Sonar analysis and snapshot deploy",
          "default": "21",
          "examples": ["21", "17"]
        },
        "enable-snapshot-deploy": {
          "type": "boolean",
          "description": "Deploy snapshots to Maven Central",
          "default": true
        },
        "maven-profiles-snapshot": {
          "type": "string",
          "description": "Maven profiles for snapshot deployment (comma-separated)",
          "default": "release-snapshot,javadoc"
        },
        "maven-profiles-release": {
          "type": "string",
          "description": "Maven profiles for release (comma-separated)",
          "default": "release,javadoc"
        },
        "npm-cache": {
          "type": "boolean",
          "description": "Enable npm package caching (for frontend projects)",
          "default": false
        },
        "skip-on-docs-only": {
          "type": "boolean",
          "description": "Skip build when only documentation/config files changed",
          "default": true
        },
        "paths-ignore-extra": {
          "type": "array",
          "description": "Additional glob patterns to treat as non-code (beyond built-in defaults)",
          "items": { "type": "string" },
          "default": [],
          "examples": [["e-2-e-playwright/docs/**"]]
        }
      },
      "additionalProperties": false
    },
    "npm-build": {
      "type": "object",
      "description": "npm build configuration for Node.js projects",
      "properties": {
        "node-version": {
          "type": "string",
          "description": "Node.js version for builds",
          "default": "22",
          "examples": ["20", "22"]
        },
        "registry-url": {
          "type": "string",
          "description": "npm registry URL for publishing",
          "default": "https://registry.npmjs.org",
          "examples": ["https://registry.npmjs.org", "https://npm.pkg.github.com"]
        }
      },
      "additionalProperties": false
    },
    "sonar": {
      "type": "object",
      "description": "SonarCloud configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable SonarCloud analysis",
          "default": true
        },
        "skip-on-dependabot": {
          "type": "boolean",
          "description": "Skip Sonar analysis for Dependabot PRs (avoids secret access issues)",
          "default": true
        },
        "project-key": {
          "type": "string",
          "description": "SonarCloud project key (required if Sonar enabled)",
          "pattern": "^[a-zA-Z0-9_-]+$",
          "examples": ["cuioss_cui-java-tools", "cuioss_my-project"]
        }
      },
      "additionalProperties": false
    },
    "release": {
      "type": "object",
      "description": "Release configuration",
      "properties": {
        "current-version": {
          "type": "string",
          "description": "Current release version (semver without -SNAPSHOT)",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+(-[a-zA-Z0-9.]+)?$",
          "examples": ["1.0.0", "2.1.0-beta.1"]
        },
        "next-version": {
          "type": "string",
          "description": "Next development version (typically ends with -SNAPSHOT)",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+(-SNAPSHOT)?$",
          "examples": ["1.1.0-SNAPSHOT", "2.2.0-SNAPSHOT"]
        },
        "create-github-release": {
          "type": "boolean",
          "description": "Create a GitHub Release with auto-generated notes",
          "default": false
        }
      },
      "additionalProperties": false
    },
    "pages": {
      "type": "object",
      "description": "GitHub Pages configuration for Maven site deployment",
      "properties": {
        "reference": {
          "type": "string",
          "description": "Folder on cuioss.github.io for Maven site",
          "examples": ["cui-java-tools", "cui-core-ui-model"]
        },
        "deploy-at-release": {
          "type": "boolean",
          "description": "Deploy Maven site to GitHub Pages during release",
          "default": true
        }
      },
      "additionalProperties": false
    },
    "pyprojectx": {
      "type": "object",
      "description": "Pyprojectx (pw) build system configuration",
      "properties": {
        "python-version": {
          "type": "string",
          "description": "Python version to use (leave empty to let uv manage from pyproject.toml)",
          "default": "",
          "examples": ["3.10", "3.12", ""]
        },
        "cache-dependency-glob": {
          "type": "string",
          "description": "Glob pattern for uv cache dependencies",
          "default": "uv.lock"
        },
        "upload-artifacts-on-failure": {
          "type": "boolean",
          "description": "Upload test artifacts (.pytest_cache, .mypy_cache) on failure",
          "default": false
        },
        "verify-command": {
          "type": "string",
          "description": "Verification command to run",
          "default": "./pw verify",
          "examples": ["./pw verify", "./pw test", "./pw quality-gate"]
        }
      },
      "additionalProperties": false
    },
    "github-automation": {
      "type": "object",
      "description": "GitHub automation settings for consumer repo workflow updates",
      "properties": {
        "auto-merge-build-versions": {
          "type": "boolean",
          "description": "Auto-merge workflow update PRs when CI checks pass",
          "default": true
        },
      },
      "additionalProperties": false
    },
    "consumers": {
      "type": "array",
      "description": "List of consumer repository names (without org prefix) that receive automatic dependency updates on release",
      "items": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9_.-]+$"
      },
      "default": [],
      "examples": [["cui-java-tools", "cui-core-ui-model"]]
    },
    "dependency-propagation": {
      "type": "object",
      "description": "Configuration for automatic dependency version propagation to consumer repos on release",
      "properties": {
        "group-id": {
          "type": "string",
          "description": "Maven groupId of the artifact to propagate (e.g., de.cuioss)",
          "examples": ["de.cuioss", "de.cuioss.jsf"]
        },
        "artifact-id": {
          "type": "string",
          "description": "Maven artifactId of the artifact to propagate (e.g., cui-java-parent)",
          "examples": ["cui-java-parent", "cui-http"]
        },
        "scope": {
          "type": "string",
          "description": "Update scope: 'parent' for parent POM version, 'dependency' for dependency/property version",
          "enum": ["parent", "dependency"],
          "default": "parent"
        }
      },
      "additionalProperties": false
    },
    "custom": {
      "type": "object",
      "description": "Custom fields for downstream repos. Each key becomes a 'custom-<key>' output.",
      "additionalProperties": {
        "oneOf": [
          { "type": "string" },
          { "type": "boolean" },
          { "type": "number" }
        ]
      },
      "examples": [
        {
          "skip-e2e": true,
          "deploy-target": "staging",
          "timeout-minutes": 30
        }
      ]
    }
  },
  "additionalProperties": true
}
