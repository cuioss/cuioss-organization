= cuioss Organization Configuration
:toc:
:toc-placement: preamble

image:https://github.com/cuioss/cuioss-organization/actions/workflows/python-verify.yml/badge.svg[Python Verify,link=https://github.com/cuioss/cuioss-organization/actions/workflows/python-verify.yml]

Centralized configuration, workflows, and tooling for all cuioss repositories.

== Overview

This repository contains shared infrastructure for the cuioss organization:

[cols="1,2"]
|===
|Directory |Purpose

|`docs/`
|Documentation (workflows, secrets, releasing, release-bot)

|`branch-protection/`
|Scripts to apply consistent branch protection across repos

|`repo-settings/`
|Scripts to apply consistent repository settings (security, features, merge)

|`.github/workflows/`
|Reusable GitHub Actions workflows
|===

== Related Repository

https://github.com/cuioss/.github[cuioss/.github] - Organization-wide community health files (SECURITY.md, CONTRIBUTING.md, issue templates) that are automatically inherited by all repos.

== Quick Start

=== 1. Release Bot Setup

The `cuioss-release-bot` GitHub App enables release workflows to bypass branch protection.

See: link:docs/cuioss-release-bot.adoc[cuioss-release-bot Documentation]

=== 2. Branch Protection

Apply consistent rulesets across all repositories:

[source,bash]
----
cd branch-protection
# Edit config.json with your repos
./setup-branch-protection.py
----

See: link:branch-protection/README.adoc[Branch Protection Documentation]

=== 3. Repository Settings

Apply consistent repo settings (security, features, merge options):

[source,bash]
----
cd repo-settings
# Edit config.json with your repos
./setup-repo-settings.py
----

See: link:repo-settings/README.adoc[Repository Settings Documentation]

=== 4. Reusable Workflows

Use centralized workflows instead of copy-pasting:

[source,yaml]
----
# In your repo's .github/workflows/release.yml
jobs:
  release:
    uses: cuioss/cuioss-organization/.github/workflows/reusable-maven-release.yml@ab9c1504e30dcc5928d86d9e0147bc1ceb35383c # v0.1.0
    secrets: inherit
----

See: link:docs/Workflows.adoc[Workflows Documentation]

=== 5. Releasing Workflow Updates

When you update the reusable workflows, create a new release:

[source,bash]
----
# Update version in .github/project.yml, then:
gh workflow run release.yml
gh run watch
git pull  # Get the SHA-updated examples
----

See: link:docs/Releasing.adoc[Releasing Documentation]

== Secrets Management

=== Organization-Level Secrets (Shared)

Set once at: `https://github.com/organizations/cuioss/settings/secrets/actions`

[cols="1,2"]
|===
|Secret |Purpose

|`RELEASE_APP_ID`
|cuioss-release-bot App ID

|`RELEASE_APP_PRIVATE_KEY`
|cuioss-release-bot private key

|`OSS_SONATYPE_USERNAME`
|Maven Central deployment

|`OSS_SONATYPE_PASSWORD`
|Maven Central deployment

|`GPG_PRIVATE_KEY`
|Artifact signing

|`GPG_PASSPHRASE`
|Artifact signing

|`PAGES_DEPLOY_TOKEN`
|GitHub Pages deployment

|`SONAR_TOKEN`
|SonarCloud analysis
|===

See: link:docs/Secrets.adoc[Secrets Documentation] for details and migration guide.

== Repository Checklist

For each repository in the organization:

* [ ] Run `repo-settings/setup-repo-settings.py` to apply settings
* [ ] Run `branch-protection/setup-branch-protection.py` to apply branch protection (includes cuioss-release-bot bypass)
* [ ] Replace workflows with reusable workflow callers (use `/update-github-actions` command)
* [ ] Ensure `.github/project.yml` exists with release metadata
* [ ] Verify no org-level secrets are duplicated at repo level (they are inherited automatically)
